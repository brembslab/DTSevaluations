paste("FP risk, prior ",priorval[2]),
"Likelihood Ratio")
# plot two PIs with asterisks
plots.2test<-list(ggplot(plotOMparams, aes(group, OMvariables[v])) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = plotOMparams, aes(group, OMvariables[v]), position=position_jitter(0.3), shape=21, size=3, colour="black", fill="grey50", alpha=0.4) +
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank(), panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab(paste(OMvariables[v], "[rel. units]", sep = ""))+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = groupnames, map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes))
#add table with results and plot
plots.2test[[2]]<-tableGrob(results.utest)
grid.arrange(grobs = plots.2test, ncol=2)
} #for v in OMvariables
setwd("B:/GitHub/DTSevaluations")
source('B:/GitHub/DTSevaluations/HTML_DTS_project.R', echo=TRUE)
cat(paste("## ", OMtitles[v], sep = ""))
utest = signif(wilcox.test(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$p.value, 3) #compare the two groups with a U-test and collect p-value
w.statistic = signif(wilcox.test(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$statistic, 3)
cohend = signif(cohen.d(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$estimate, 3)
power=signif(pwr.t2n.test(n1 = samplesizes[1], n2= samplesizes[2], d = cohend, alternative = alt, sig.level = signif[1])$power, 3)
alt = project.data[["statistics"]][["two.groups"]][["power"]]
alt=less
alt="less"
power=signif(pwr.t2n.test(n1 = samplesizes[1], n2= samplesizes[2], d = cohend, alternative = alt, sig.level = signif[1])$power, 3)
alt = project.data[["statistics"]][["two.groups"]][["power"]]
pwr.t2n.test(n1 = samplesizes[1], n2= samplesizes[2], d = cohend, alternative = alt, sig.level = signif[1])
samplesizes[1]
samplesizes[2]
cohend
alt
signif[1]
two <- project.data[["statistics"]][["two.groups"]][["data"]]==1 || NofGroups==2 #determine if we need to do between groups tests
signif = project.data[["statistics"]][["significance-levels"]]               #get significance levels
samplesizes = as.numeric(table(plotOMparams$group))                          #determine sample sizes
OMvariables = head(names(plotOMparams),-1)
OMtitles = c("Optomotor Magnitude", "Halfmaximal Rise Time", "Asymmetry Index")
for (v in length(OMvariables)) {
cat(paste("## ", OMtitles[v], sep = ""))
utest = signif(wilcox.test(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$p.value, 3) #compare the two groups with a U-test and collect p-value
w.statistic = signif(wilcox.test(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$statistic, 3)
#compute effect size Cohen's D
cohend = signif(cohen.d(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$estimate, 3)
#calculate statistical power
alt = project.data[["statistics"]][["two.groups"]][["power"]]
power=signif(pwr.t2n.test(n1 = samplesizes[1], n2= samplesizes[2], d = cohend, alternative = alt, sig.level = signif[1])$power, 3)
#calculate Bayes Factor
bayesF=extractBF(ttestBF(plotOMparams[[OMvariables[v]]][plotOMparams$group==groupnames[1]], plotOMparams[[OMvariables[v]]][plotOMparams$group==groupnames[2]]))
#calculate FPR for priors set in project file#
#run first prior
prior=priorval[1]
out=calc.FPR(samplesizes,utest,prior,abs(cohend))  #output=c(FPR,x0,y0,x1,y1)
fpz1=out[1]
#run second prior
prior=priorval[2]
out=calc.FPR(samplesizes,utest,prior,abs(cohend))  #output=c(FPR,x0,y0,x1,y1)
fpz2=out[1]
#Power and likelihood ratio: NB for two sided test, need 2*y0
LR=out[5]/(2*out[3])        #lik ratio (Hi1/H0) =y1/2*y0
#make tidy table of results
results.utest<-data.frame(values=c(signif[1],
w.statistic,
cohend,
power,
signif(bayesF$bf, 3),
signif(bayesF$error, 3),
signif(fpz1, 3),
signif(fpz2, 3),
signif(LR, 3)))
rownames(results.utest)<-c("Significance level",
"MW U-Test, W",
"Cohen's D",
"stat. Power",
"Bayes Factor",
"Bayes Factor error",
paste("FP risk, prior ",priorval[1]),
paste("FP risk, prior ",priorval[2]),
"Likelihood Ratio")
# plot two PIs with asterisks
plots.2test<-list(ggplot(plotOMparams, aes(group, OMvariables[v])) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = plotOMparams, aes(group, OMvariables[v]), position=position_jitter(0.3), shape=21, size=3, colour="black", fill="grey50", alpha=0.4) +
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank(), panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = groupnames, map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes))
#add table with results and plot
plots.2test[[2]]<-tableGrob(results.utest)
grid.arrange(grobs = plots.2test, ncol=2)
}
two <- project.data[["statistics"]][["two.groups"]][["data"]]==1 || NofGroups==2     #determine if we need to do between groups tests
signif = project.data[["statistics"]][["significance-levels"]]                   #get significance levels
groupnames <- unlist(sapply(project.data[["resources"]], function(x) x["name"])) #get a vector with all group names
priorval = project.data[["statistics"]][["priors"]]                              # get priors for FPR calculation
for (v in length(OMvariables)) {
cat(paste("## ", OMtitles[v], sep = ""))
utest = signif(wilcox.test(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$p.value, 3) #compare the two groups with a U-test and collect p-value
w.statistic = signif(wilcox.test(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$statistic, 3)
#compute effect size Cohen's D
cohend = signif(cohen.d(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$estimate, 3)
#calculate statistical power
alt = project.data[["statistics"]][["two.groups"]][["power"]]
power=signif(pwr.t2n.test(n1 = samplesizes[1], n2= samplesizes[2], d = cohend, alternative = alt, sig.level = signif[1])$power, 3)
#calculate Bayes Factor
bayesF=extractBF(ttestBF(plotOMparams[[OMvariables[v]]][plotOMparams$group==groupnames[1]], plotOMparams[[OMvariables[v]]][plotOMparams$group==groupnames[2]]))
#calculate FPR for priors set in project file#
#run first prior
prior=priorval[1]
out=calc.FPR(samplesizes,utest,prior,abs(cohend))  #output=c(FPR,x0,y0,x1,y1)
fpz1=out[1]
#run second prior
prior=priorval[2]
out=calc.FPR(samplesizes,utest,prior,abs(cohend))  #output=c(FPR,x0,y0,x1,y1)
fpz2=out[1]
#Power and likelihood ratio: NB for two sided test, need 2*y0
LR=out[5]/(2*out[3])        #lik ratio (Hi1/H0) =y1/2*y0
#make tidy table of results
results.utest<-data.frame(values=c(signif[1],
w.statistic,
cohend,
power,
signif(bayesF$bf, 3),
signif(bayesF$error, 3),
signif(fpz1, 3),
signif(fpz2, 3),
signif(LR, 3)))
rownames(results.utest)<-c("Significance level",
"MW U-Test, W",
"Cohen's D",
"stat. Power",
"Bayes Factor",
"Bayes Factor error",
paste("FP risk, prior ",priorval[1]),
paste("FP risk, prior ",priorval[2]),
"Likelihood Ratio")
# plot two PIs with asterisks
plots.2test<-list(ggplot(plotOMparams, aes(group, OMvariables[v])) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = plotOMparams, aes(group, OMvariables[v]), position=position_jitter(0.3), shape=21, size=3, colour="black", fill="grey50", alpha=0.4) +
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank(), panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = groupnames, map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes))
#add table with results and plot
plots.2test[[2]]<-tableGrob(results.utest)
grid.arrange(grobs = plots.2test, ncol=2)
}
ggplot(plotOMparams, aes(group, OMvariables[v])) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = plotOMparams, aes(group, OMvariables[v]), position=position_jitter(0.3), shape=21, size=3, colour="black", fill="grey50", alpha=0.4) +
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank(), panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = groupnames, map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes)
v=2
ggplot(plotOMparams, aes(group, OMvariables[v])) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = plotOMparams, aes(group, OMvariables[v]), position=position_jitter(0.3), shape=21, size=3, colour="black", fill="grey50", alpha=0.4) +
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank(), panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = groupnames, map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes)
v=1
ggplot(plotOMparams, aes(group, OMvariables[v])) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = plotOMparams, aes(group, OMvariables[v]), position=position_jitter(0.3), shape=21, size=3, colour="black", fill="grey50", alpha=0.4) +
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank(), panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = groupnames, map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes)
ggplot(plotOMparams, aes(group, OMvariables[[v]])) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = plotOMparams, aes(group, OMvariables[[v]]), position=position_jitter(0.3), shape=21, size=3, colour="black", fill="grey50", alpha=0.4) +
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank(), panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = groupnames, map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes)
ggplot(plotOMparams, aes(group, OMvariables$asmyptote)) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = plotOMparams, aes(group, OMvariables$asymptote), position=position_jitter(0.3), shape=21, size=3, colour="black", fill="grey50", alpha=0.4) +
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank(), panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = groupnames, map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes)
ggplot(plotOMparams, aes(group, asymptote)) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = plotOMparams, aes(group, asymptote), position=position_jitter(0.3), shape=21, size=3, colour="black", fill="grey50", alpha=0.4) +
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank(), panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = groupnames, map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes)
ggplot(plotOMparams, aes(group, asymptote)) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = plotOMparams, aes(group, asymptote), position=position_jitter(0.3), shape=21, size=3, colour="black", fill="grey50", alpha=0.4) +
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank(), panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = groupnames, map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes)
ggplot(plotOMparams, aes(group, as.character(OMvariables[1]))) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = plotOMparams, aes(group, as.character(OMvariables[1])), position=position_jitter(0.3), shape=21, size=3, colour="black", fill="grey50", alpha=0.4) +
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank(), panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = groupnames, map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes)
ggplot(plotOMparams, aes(group, plotOMparams[OMvariables[1]])) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = plotOMparams, aes(group, plotOMparams[OMvariables[1]]), position=position_jitter(0.3), shape=21, size=3, colour="black", fill="grey50", alpha=0.4) +
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank(), panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = groupnames, map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes)
ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[1]]])) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = plotOMparams, aes(group, plotOMparams[[OMvariables[1]]]), position=position_jitter(0.3), shape=21, size=3, colour="black", fill="grey50", alpha=0.4) +
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank(), panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = groupnames, map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes)
for (v in length(OMvariables)) {
cat(paste("## ", OMtitles[v], sep = ""))
utest = signif(wilcox.test(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$p.value, 3) #compare the two groups with a U-test and collect p-value
w.statistic = signif(wilcox.test(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$statistic, 3)
#compute effect size Cohen's D
cohend = signif(cohen.d(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$estimate, 3)
#calculate statistical power
alt = project.data[["statistics"]][["two.groups"]][["power"]]
power=signif(pwr.t2n.test(n1 = samplesizes[1], n2= samplesizes[2], d = cohend, alternative = alt, sig.level = signif[1])$power, 3)
#calculate Bayes Factor
bayesF=extractBF(ttestBF(plotOMparams[[OMvariables[v]]][plotOMparams$group==groupnames[1]], plotOMparams[[OMvariables[v]]][plotOMparams$group==groupnames[2]]))
#calculate FPR for priors set in project file#
#run first prior
prior=priorval[1]
out=calc.FPR(samplesizes,utest,prior,abs(cohend))  #output=c(FPR,x0,y0,x1,y1)
fpz1=out[1]
#run second prior
prior=priorval[2]
out=calc.FPR(samplesizes,utest,prior,abs(cohend))  #output=c(FPR,x0,y0,x1,y1)
fpz2=out[1]
#Power and likelihood ratio: NB for two sided test, need 2*y0
LR=out[5]/(2*out[3])        #lik ratio (Hi1/H0) =y1/2*y0
#make tidy table of results
results.utest<-data.frame(values=c(signif[1],
w.statistic,
cohend,
power,
signif(bayesF$bf, 3),
signif(bayesF$error, 3),
signif(fpz1, 3),
signif(fpz2, 3),
signif(LR, 3)))
rownames(results.utest)<-c("Significance level",
"MW U-Test, W",
"Cohen's D",
"stat. Power",
"Bayes Factor",
"Bayes Factor error",
paste("FP risk, prior ",priorval[1]),
paste("FP risk, prior ",priorval[2]),
"Likelihood Ratio")
# plot two PIs with asterisks
plots.2test<-list(ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[1]]])) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = plotOMparams, aes(group, plotOMparams[[OMvariables[1]]]), position=position_jitter(0.3), shape=21, size=3, colour="black", fill="grey50", alpha=0.4) +
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank(), panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = groupnames, map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes))
#add table with results and plot
plots.2test[[2]]<-tableGrob(results.utest)
grid.arrange(grobs = plots.2test, ncol=2)
}
for (v in length(OMvariables)) {
cat(paste("## ", OMtitles[v], sep = ""))
utest = signif(wilcox.test(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$p.value, 3) #compare the two groups with a U-test and collect p-value
w.statistic = signif(wilcox.test(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$statistic, 3)
#compute effect size Cohen's D
cohend = signif(cohen.d(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$estimate, 3)
#calculate statistical power
alt = project.data[["statistics"]][["two.groups"]][["power"]]
power=signif(pwr.t2n.test(n1 = samplesizes[1], n2= samplesizes[2], d = cohend, alternative = alt, sig.level = signif[1])$power, 3)
#calculate Bayes Factor
bayesF=extractBF(ttestBF(plotOMparams[[OMvariables[v]]][plotOMparams$group==groupnames[1]], plotOMparams[[OMvariables[v]]][plotOMparams$group==groupnames[2]]))
#calculate FPR for priors set in project file#
#run first prior
prior=priorval[1]
out=calc.FPR(samplesizes,utest,prior,abs(cohend))  #output=c(FPR,x0,y0,x1,y1)
fpz1=out[1]
#run second prior
prior=priorval[2]
out=calc.FPR(samplesizes,utest,prior,abs(cohend))  #output=c(FPR,x0,y0,x1,y1)
fpz2=out[1]
#Power and likelihood ratio: NB for two sided test, need 2*y0
LR=out[5]/(2*out[3])        #lik ratio (Hi1/H0) =y1/2*y0
#make tidy table of results
results.utest<-data.frame(values=c(signif[1],
w.statistic,
cohend,
power,
signif(bayesF$bf, 3),
signif(bayesF$error, 3),
signif(fpz1, 3),
signif(fpz2, 3),
signif(LR, 3)))
rownames(results.utest)<-c("Significance level",
"MW U-Test, W",
"Cohen's D",
"stat. Power",
"Bayes Factor",
"Bayes Factor error",
paste("FP risk, prior ",priorval[1]),
paste("FP risk, prior ",priorval[2]),
"Likelihood Ratio")
# plot two PIs with asterisks
plots.2test<-list(ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[v]]])) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = plotOMparams, aes(group, plotOMparams[[OMvariables[v]]]), position=position_jitter(0.3), shape=21, size=3, colour="black", fill="grey50", alpha=0.4) +
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank(), panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = groupnames, map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes))
#add table with results and plot
plots.2test[[2]]<-tableGrob(results.utest)
grid.arrange(grobs = plots.2test, ncol=2)
}
setwd("B:/GitHub/DTSevaluations")
source('B:/GitHub/DTSevaluations/HTML_DTS_project.R', echo=TRUE)
setwd("B:/GitHub/DTSevaluations")
source('B:/GitHub/DTSevaluations/HTML_DTS_project.R', echo=TRUE)
for (v in 1:3) {
cat(paste("## ", OMtitles[v], sep = ""))
utest = signif(wilcox.test(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$p.value, 3) #compare the two groups with a U-test and collect p-value
w.statistic = signif(wilcox.test(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$statistic, 3)
#compute effect size Cohen's D
cohend = signif(cohen.d(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$estimate, 3)
#calculate statistical power
alt = project.data[["statistics"]][["two.groups"]][["power"]]
power=signif(pwr.t2n.test(n1 = samplesizes[1], n2= samplesizes[2], d = cohend, alternative = alt, sig.level = signif[1])$power, 3)
#calculate Bayes Factor
bayesF=extractBF(ttestBF(plotOMparams[[OMvariables[v]]][plotOMparams$group==groupnames[1]], plotOMparams[[OMvariables[v]]][plotOMparams$group==groupnames[2]]))
#calculate FPR for priors set in project file#
#run first prior
prior=priorval[1]
out=calc.FPR(samplesizes,utest,prior,abs(cohend))  #output=c(FPR,x0,y0,x1,y1)
fpz1=out[1]
#run second prior
prior=priorval[2]
out=calc.FPR(samplesizes,utest,prior,abs(cohend))  #output=c(FPR,x0,y0,x1,y1)
fpz2=out[1]
#Power and likelihood ratio: NB for two sided test, need 2*y0
LR=out[5]/(2*out[3])        #lik ratio (Hi1/H0) =y1/2*y0
#make tidy table of results
results.utest<-data.frame(values=c(signif[1],
w.statistic,
cohend,
power,
signif(bayesF$bf, 3),
signif(bayesF$error, 3),
signif(fpz1, 3),
signif(fpz2, 3),
signif(LR, 3)))
rownames(results.utest)<-c("Significance level",
"MW U-Test, W",
"Cohen's D",
"stat. Power",
"Bayes Factor",
"Bayes Factor error",
paste("FP risk, prior ",priorval[1]),
paste("FP risk, prior ",priorval[2]),
"Likelihood Ratio")
# plot two PIs with asterisks
plots.2test<-list(ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[v]]])) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = plotOMparams, aes(group, plotOMparams[[OMvariables[v]]]), position=position_jitter(0.3), shape=21, size=3, colour="black", fill="grey50", alpha=0.4) +
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank(), panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = groupnames, map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes))
#add table with results and plot
plots.2test[[2]]<-tableGrob(results.utest)
grid.arrange(grobs = plots.2test, ncol=2)
} #for v in OMvariables
setwd("B:/GitHub/DTSevaluations")
source('B:/GitHub/DTSevaluations/HTML_DTS_project.R', echo=TRUE)
for (v in 1:3) {
cat(paste("## ", OMtitles[v], sep = ""))
utest = signif(wilcox.test(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$p.value, 3) #compare the two groups with a U-test and collect p-value
w.statistic = signif(wilcox.test(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$statistic, 3)
#compute effect size Cohen's D
cohend = signif(cohen.d(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$estimate, 3)
#calculate statistical power
alt = project.data[["statistics"]][["two.groups"]][["power"]]
power=signif(pwr.t2n.test(n1 = samplesizes[1], n2= samplesizes[2], d = cohend, alternative = alt, sig.level = signif[1])$power, 3)
#calculate Bayes Factor
bayesF=extractBF(ttestBF(plotOMparams[[OMvariables[v]]][plotOMparams$group==groupnames[1]], plotOMparams[[OMvariables[v]]][plotOMparams$group==groupnames[2]]))
#calculate FPR for priors set in project file#
#run first prior
prior=priorval[1]
out=calc.FPR(samplesizes,utest,prior,abs(cohend))  #output=c(FPR,x0,y0,x1,y1)
fpz1=out[1]
#run second prior
prior=priorval[2]
out=calc.FPR(samplesizes,utest,prior,abs(cohend))  #output=c(FPR,x0,y0,x1,y1)
fpz2=out[1]
#Power and likelihood ratio: NB for two sided test, need 2*y0
LR=out[5]/(2*out[3])        #lik ratio (Hi1/H0) =y1/2*y0
#make tidy table of results
results.utest<-data.frame(values=c(signif[1],
w.statistic,
cohend,
power,
signif(bayesF$bf, 3),
signif(bayesF$error, 3),
signif(fpz1, 3),
signif(fpz2, 3),
signif(LR, 3)))
rownames(results.utest)<-c("Significance level",
"MW U-Test, W",
"Cohen's D",
"stat. Power",
"Bayes Factor",
"Bayes Factor error",
paste("FP risk, prior ",priorval[1]),
paste("FP risk, prior ",priorval[2]),
"Likelihood Ratio")
# plot two PIs with asterisks
plots.2test<-list(ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[v]]])) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = plotOMparams, aes(group, plotOMparams[[OMvariables[v]]]), position=position_jitter(0.3), shape=21, size=3, colour="black", fill="grey50", alpha=0.4) +
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank(), panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = groupnames, map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes))
#add table with results and plot
plots.2test[[2]]<-tableGrob(results.utest)
grid.arrange(grobs = plots.2test, ncol=2)
} #for
for (v in 1:3) {
cat(paste("## ", OMtitles[v], "/n", sep = ""))
utest = signif(wilcox.test(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$p.value, 3) #compare the two groups with a U-test and collect p-value
w.statistic = signif(wilcox.test(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$statistic, 3)
#compute effect size Cohen's D
cohend = signif(cohen.d(plotOMparams[[OMvariables[v]]] ~ plotOMparams$group)$estimate, 3)
#calculate statistical power
alt = project.data[["statistics"]][["two.groups"]][["power"]]
power=signif(pwr.t2n.test(n1 = samplesizes[1], n2= samplesizes[2], d = cohend, alternative = alt, sig.level = signif[1])$power, 3)
#calculate Bayes Factor
bayesF=extractBF(ttestBF(plotOMparams[[OMvariables[v]]][plotOMparams$group==groupnames[1]], plotOMparams[[OMvariables[v]]][plotOMparams$group==groupnames[2]]))
#calculate FPR for priors set in project file#
#run first prior
prior=priorval[1]
out=calc.FPR(samplesizes,utest,prior,abs(cohend))  #output=c(FPR,x0,y0,x1,y1)
fpz1=out[1]
#run second prior
prior=priorval[2]
out=calc.FPR(samplesizes,utest,prior,abs(cohend))  #output=c(FPR,x0,y0,x1,y1)
fpz2=out[1]
#Power and likelihood ratio: NB for two sided test, need 2*y0
LR=out[5]/(2*out[3])        #lik ratio (Hi1/H0) =y1/2*y0
#make tidy table of results
results.utest<-data.frame(values=c(signif[1],
w.statistic,
cohend,
power,
signif(bayesF$bf, 3),
signif(bayesF$error, 3),
signif(fpz1, 3),
signif(fpz2, 3),
signif(LR, 3)))
rownames(results.utest)<-c("Significance level",
"MW U-Test, W",
"Cohen's D",
"stat. Power",
"Bayes Factor",
"Bayes Factor error",
paste("FP risk, prior ",priorval[1]),
paste("FP risk, prior ",priorval[2]),
"Likelihood Ratio")
# plot two PIs with asterisks
plots.2test<-list(ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[v]]])) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = plotOMparams, aes(group, plotOMparams[[OMvariables[v]]]), position=position_jitter(0.3), shape=21, size=3, colour="black", fill="grey50", alpha=0.4) +
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank(), panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = groupnames, map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes))
#add table with results and plot
plots.2test[[2]]<-tableGrob(results.utest)
grid.arrange(grobs = plots.2test, ncol=2)
} #for
setwd("B:/GitHub/DTSevaluations")
source('B:/GitHub/DTSevaluations/HTML_DTS_project.R', echo=TRUE)
source('B:/GitHub/DTSevaluations/HTML_DTS_project.R', echo=TRUE)
source('B:/GitHub/DTSevaluations/HTML_DTS_project.R', echo=TRUE)
