hist(x = df$fly, breaks = 100,xlim = round(range(subset$fly))*1.1, xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plot new hist
}
abline(v = 0, col="black", lwd=2, lty=2) # adds a line at 0
mtext(text = paste(FlyBehavior, "[arb units]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
i=5
hist(x = df$fly, breaks = 100,xlim = round(range(subset$fly))*1.1, xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i)) #plots the data as a histogram
if(sequence$contingency[i]=="left_torque"){          #shade left torque area
rect(-2000, 0, 0, 500, col=("lightgrey"))
hist(x = df$fly, breaks = 100,xlim = round(range(subset$fly))*1.1, xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plot new hist
} else if(sequence$contingency[i]=="right_torque"){  #shade right torque area
rect(0, 0, 2000, 500, col=("lightgrey"))
hist(x = df$fly, breaks = 100,xlim = round(range(subset$fly))*1.1, xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plot new hist
}
abline(v = 0, col="black", lwd=2, lty=2) # adds a line at 0
mtext(text = paste(FlyBehavior, "[arb units]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
hist(x = df$a_pos, breaks = 1800,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i)) #plots the data as a histogram
#add shading in case of torque/switch learning
abline(v = 0, col="black", lwd=2, lty=2) # adds a line at 0
mtext(text = paste(FlyBehavior, "[arb units]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
source('B:/GitHub/DTSevaluations/HTML_DTS_project.R', echo=TRUE)
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i)) #plots the data as a histogram
#add shading in case of torque/switch learning
if(sequence$contingency[i]=="1_3_Q"){  #shade first and third quadrant
rect(-1800, 0, -1350, 500, col=("lightgrey"))
rect(-450, 0, 450, 500, col=("lightgrey"))
rect(1350, 0, 1800, 500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i)) #plots histogram again
} else {
rext(-1350,0,-450,500, col=("lightgrey"))
rext(450,0,1350,500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i)) #plots histogram again
}
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i)) #plots the data as a histogram
#add shading in case of torque/switch learning
if(sequence$contingency[i]=="1_3_Q"){  #shade first and third quadrant
rect(-1800, 0, -1350, 500, col=("lightgrey"))
rect(-450, 0, 450, 500, col=("lightgrey"))
rect(1350, 0, 1800, 500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i)) #plots histogram again
} else {
rect(-1350,0,-450,500, col=("lightgrey"))
rect(450,0,1350,500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i)) #plots histogram again
}
abline(v = 0, col="black", lwd=2, lty=2) # adds a line at 0
abline(v = 900, col="black", lwd=2, lty=2) # adds a line at 90°
abline(v = -900, col="black", lwd=2, lty=2) # adds a line at -90°
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i)) #plots the data as a histogram
#add shading in case of torque/switch learning
if(sequence$contingency[i]=="1_3_Q"){  #shade first and third quadrant
rect(-1800, 0, -1350, 500, col=("lightgrey"))
rect(-450, 0, 450, 500, col=("lightgrey"))
rect(1350, 0, 1800, 500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
} else {
rect(-1350,0,-450,500, col=("lightgrey"))
rect(450,0,1350,500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
}
abline(v = 0, col="black", lwd=2, lty=2) # adds a line at 0
abline(v = 900, col="black", lwd=2, lty=2) # adds a line at 90°
abline(v = -900, col="black", lwd=2, lty=2) # adds a line at -90°
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
subset = rawdata[c("fly","period","a_pos")]
subset$period = as.factor(subset$period)
par(mfrow=c(round(NofPeriods/2), 2)) # sets the dimension of the multiplot, row x column
old.par = par(mar = c(0, 0, 4, 0)) # sets the margins for the plots (bottom, left, top and right margins respectively)
for (i in 1:NofPeriods){
df = subset(subset, subset$period == i) # subset the data for only one period
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i)) #plots the data as a histogram
#add shading in case of torque/switch learning
if(sequence$contingency[i]=="1_3_Q"){  #shade first and third quadrant
rect(-1800, 0, -1350, 500, col=("lightgrey"))
rect(-450, 0, 450, 500, col=("lightgrey"))
rect(1350, 0, 1800, 500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
} else {
rect(-1350,0,-450,500, col=("lightgrey"))
rect(450,0,1350,500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
}
abline(v = 0, col="black", lwd=2, lty=2) # adds a line at 0
abline(v = 900, col="black", lwd=2, lty=2) # adds a line at 90°
abline(v = -900, col="black", lwd=2, lty=2) # adds a line at -90°
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
}
hist(subset$a_pos, breaks = 1800, border = "grey40", col = "grey40", main=paste(flyname, "Total"), xlab="", ylab = "") #histogram of pooled data
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
subset = rawdata[c("fly","period","a_pos")]
subset$period = as.factor(subset$period)
par(mfrow=c(round(NofPeriods/2), 2)) # sets the dimension of the multiplot, row x column
old.par = par(mar = c(4, 4, 1, 0)) # sets the margins for the plots (bottom, left, top and right margins respectively)
for (i in 1:NofPeriods){
df = subset(subset, subset$period == i) # subset the data for only one period
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i)) #plots the data as a histogram
#add shading in case of torque/switch learning
if(sequence$contingency[i]=="1_3_Q"){  #shade first and third quadrant
rect(-1800, 0, -1350, 500, col=("lightgrey"))
rect(-450, 0, 450, 500, col=("lightgrey"))
rect(1350, 0, 1800, 500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
} else {
rect(-1350,0,-450,500, col=("lightgrey"))
rect(450,0,1350,500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
}
abline(v = 0, col="black", lwd=2, lty=2) # adds a line at 0
abline(v = 900, col="black", lwd=2, lty=2) # adds a line at 90°
abline(v = -900, col="black", lwd=2, lty=2) # adds a line at -90°
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
}
hist(subset$a_pos, breaks = 1800, border = "grey40", col = "grey40", main=paste(flyname, "Total"), xlab="", ylab = "") #histogram of pooled data
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
subset = rawdata[c("fly","period","a_pos")]
subset$period = as.factor(subset$period)
par(mfrow=c(round(NofPeriods/2), 2)) # sets the dimension of the multiplot, row x column
old.par = par(mar = c(4, 4, 1, 0)) # sets the margins for the plots (bottom, left, top and right margins respectively)
for (i in 1:NofPeriods){
df = subset(subset, subset$period == i) # subset the data for only one period
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i)) #plots the data as a histogram
#add shading in case of torque/switch learning
if(sequence$contingency[i]=="1_3_Q"){  #shade first and third quadrant
rect(-1800, 0, -1350, 500, col=("lightgrey"))
rect(-450, 0, 450, 500, col=("lightgrey"))
rect(1350, 0, 1800, 500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
} else {
rect(-1350,0,-450,500, col=("lightgrey"))
rect(450,0,1350,500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
}
abline(v = 0, col="black", lwd=2, lty=2) # adds a line at 0
abline(v = 900, col="black", lwd=2, lty=2) # adds a line at 90°
abline(v = -900, col="black", lwd=2, lty=2) # adds a line at -90°
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
}
hist(subset$a_pos, breaks = 1800, border = "grey40", col = "grey40", main=paste(flyname, "Total"), xlab="", ylab = "") #histogram of pooled data
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
hist(subset$a_pos, breaks = 1800, border = "grey40", col = "grey40", main=paste(flyname, "Total"), xlab="", ylab = "") #histogram of pooled data
axis(side=1, at=c(-1800, -900, 0, 900, 1800))
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
hist(subset$a_pos, breaks = 1800, border = "grey40", col = "grey40", main=paste(flyname, "Total"), xlab="", ylab = "", xaxt='n') #histogram of pooled data
axis(side=1, at=c(-1800, -900, 0, 900, 1800))
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), xaxt='n') #plots the data as a histogram
#add shading in case of torque/switch learning
if(sequence$contingency[i]=="1_3_Q"){  #shade first and third quadrant
rect(-1800, 0, -1350, 500, col=("lightgrey"))
rect(-450, 0, 450, 500, col=("lightgrey"))
rect(1350, 0, 1800, 500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
} else {
rect(-1350,0,-450,500, col=("lightgrey"))
rect(450,0,1350,500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
}
abline(v = 0, col="black", lwd=2, lty=2) # adds a line at 0
abline(v = 900, col="black", lwd=2, lty=2) # adds a line at 90°
abline(v = -900, col="black", lwd=2, lty=2) # adds a line at -90°
axis(side=1, at=c(-1800, -900, 0, 900, 1800))
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
hist(x = df$a_pos, breaks = 450,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), xaxt='n') #plots the data as a histogram
#add shading in case of torque/switch learning
if(sequence$contingency[i]=="1_3_Q"){  #shade first and third quadrant
rect(-1800, 0, -1350, 500, col=("lightgrey"))
rect(-450, 0, 450, 500, col=("lightgrey"))
rect(1350, 0, 1800, 500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
} else {
rect(-1350,0,-450,500, col=("lightgrey"))
rect(450,0,1350,500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
}
abline(v = 0, col="black", lwd=2, lty=2) # adds a line at 0
abline(v = 900, col="black", lwd=2, lty=2) # adds a line at 90°
abline(v = -900, col="black", lwd=2, lty=2) # adds a line at -90°
axis(side=1, at=c(-1800, -900, 0, 900, 1800))
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
hist(x = df$a_pos, breaks = 225,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), xaxt='n') #plots the data as a histogram
#add shading in case of torque/switch learning
if(sequence$contingency[i]=="1_3_Q"){  #shade first and third quadrant
rect(-1800, 0, -1350, 500, col=("lightgrey"))
rect(-450, 0, 450, 500, col=("lightgrey"))
rect(1350, 0, 1800, 500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
} else {
rect(-1350,0,-450,500, col=("lightgrey"))
rect(450,0,1350,500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
}
abline(v = 0, col="black", lwd=2, lty=2) # adds a line at 0
abline(v = 900, col="black", lwd=2, lty=2) # adds a line at 90°
abline(v = -900, col="black", lwd=2, lty=2) # adds a line at -90°
axis(side=1, at=c(-1800, -900, 0, 900, 1800))
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
hist(x = df$a_pos, breaks = 360,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), xaxt='n') #plots the data as a histogram
#add shading in case of torque/switch learning
if(sequence$contingency[i]=="1_3_Q"){  #shade first and third quadrant
rect(-1800, 0, -1350, 500, col=("lightgrey"))
rect(-450, 0, 450, 500, col=("lightgrey"))
rect(1350, 0, 1800, 500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
} else {
rect(-1350,0,-450,500, col=("lightgrey"))
rect(450,0,1350,500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
}
abline(v = 0, col="black", lwd=2, lty=2) # adds a line at 0
abline(v = 900, col="black", lwd=2, lty=2) # adds a line at 90°
abline(v = -900, col="black", lwd=2, lty=2) # adds a line at -90°
axis(side=1, at=c(-1800, -900, 0, 900, 1800))
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
hist(x = df$a_pos, breaks = 180,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), xaxt='n') #plots the data as a histogram
#add shading in case of torque/switch learning
if(sequence$contingency[i]=="1_3_Q"){  #shade first and third quadrant
rect(-1800, 0, -1350, 500, col=("lightgrey"))
rect(-450, 0, 450, 500, col=("lightgrey"))
rect(1350, 0, 1800, 500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
} else {
rect(-1350,0,-450,500, col=("lightgrey"))
rect(450,0,1350,500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
}
abline(v = 0, col="black", lwd=2, lty=2) # adds a line at 0
abline(v = 900, col="black", lwd=2, lty=2) # adds a line at 90°
abline(v = -900, col="black", lwd=2, lty=2) # adds a line at -90°
axis(side=1, at=c(-1800, -900, 0, 900, 1800))
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
hist(subset$a_pos, breaks = 360, border = "grey40", col = "grey40", main=paste(flyname, "Total"), xlab="", ylab = "", xaxt='n') #histogram of pooled data
axis(side=1, at=c(-1800, -900, 0, 900, 1800))
abline(v = 0, col="black", lwd=2, lty=2) # adds a line at 0
abline(v = 900, col="black", lwd=2, lty=2) # adds a line at 90°
abline(v = -900, col="black", lwd=2, lty=2) # adds a line at -90°
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
hist(subset$a_pos, breaks = 360, border = "grey40", col = "grey40", main=paste(flyname, "Total"), xlab="", ylab = "", xaxt='n') #histogram of pooled data
axis(side=1, at=c(-1800, -900, 0, 900, 1800))
#add quadrant borders
abline(v = -1350, col="black", lwd=1, lty=1) # adds a line at -135°
abline(v = -450, col="black", lwd=1, lty=1) # adds a line at 90°
abline(v = 450, col="black", lwd=1, lty=1) # adds a line at -90°
abline(v = 1350, col="black", lwd=1, lty=1) # adds a line at -90°
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
hist(subset$a_pos, breaks = 360, border = "grey40", col = "grey40", main=paste(flyname, "Total"), xlab="", ylab = "", xaxt='n') #histogram of pooled data
axis(side=1, at=c(-1800, -900, 0, 900, 1800))
#add quadrant borders
abline(v = -1350, col="black", lwd=1, lty="dotted") # adds a line at -135°
abline(v = -450, col="black", lwd=1, lty="dotted") # adds a line at -45°
abline(v = 450, col="black", lwd=1, lty="dotted") # adds a line at 45°
abline(v = 1350, col="black", lwd=1, lty="dotted") # adds a line at 135°
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
hist(x = df$a_pos, breaks = 180,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), xaxt='n') #plots the data as a histogram
#add shading in case of torque/switch learning
if(sequence$contingency[i]=="1_3_Q"){  #shade first and third quadrant
rect(-1800, 0, -1350, 500, col=("lightgrey"))
rect(-450, 0, 450, 500, col=("lightgrey"))
rect(1350, 0, 1800, 500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
} else {
rect(-1350,0,-450,500, col=("lightgrey"))
rect(450,0,1350,500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
}
abline(v = 0, col="black", lwd=1, lty="dotted") # adds a line at 0
abline(v = 900, col="black", lwd=1, lty="dotted") # adds a line at 90°
abline(v = -900, col="black", lwd=1, lty="dotted") # adds a line at -90°
axis(side=1, at=c(-1800, -900, 0, 900, 1800))
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
hist(x = df$a_pos, breaks = 180,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), xaxt='n', yaxs="i") #plots the data as a histogram
#add shading in case of torque/switch learning
if(sequence$contingency[i]=="1_3_Q"){  #shade first and third quadrant
rect(-1800, 0, -1350, 500, col=("lightgrey"))
rect(-450, 0, 450, 500, col=("lightgrey"))
rect(1350, 0, 1800, 500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
} else {
rect(-1350,0,-450,500, col=("lightgrey"))
rect(450,0,1350,500, col=("lightgrey"))
hist(x = df$a_pos, breaks = 900,xlim = c(-1800,1800), xlab="", ylab = "", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add = TRUE) #plots histogram again
}
abline(v = 0, col="black", lwd=1, lty="dotted") # adds a line at 0
abline(v = 900, col="black", lwd=1, lty="dotted") # adds a line at 90°
abline(v = -900, col="black", lwd=1, lty="dotted") # adds a line at -90°
axis(side=1, at=c(-1800, -900, 0, 900, 1800))
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
source('B:/GitHub/DTSevaluations/HTML_DTS_project.R', echo=TRUE)
knitr::opts_chunk$set(echo = TRUE)
df = subset(grouphistdata[[x]], grouphistdata[[x]]$period == i)
maxfly = c(-round_any(max(abs(range(df$fly))), 100, f=ceiling),round_any(max(abs(range(df$fly))), 100, f=ceiling))
hist(x = df$fly, breaks = 100,xlim = maxfly, xlab="", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i))
if(sequence$contingency[i]=="left_torque"){          #shade left torque area
rect(-2000, 0, 0, 500, col=("lightgrey"))
hist(x = df$fly, breaks = 100,xlim = maxfly, xlab="", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add=TRUE)
} else if(sequence$contingency[i]=="right_torque"){  #shade right torque area
rect(0, 0, 2000, 500, col=("lightgrey"))
hist(x = df$fly, breaks = 100,xlim = maxfly, xlab="", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add=TRUE)
}
abline(v = 0, col="black", lwd=2, lty=2)
hist(x = df$fly, breaks = 100,xlim = maxfly, xlab="", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i))
if(sequence$contingency[i]=="left_torque"){          #shade left torque area
rect(-2000, 0, 0, 50000, col=("lightgrey"))
hist(x = df$fly, breaks = 100,xlim = maxfly, xlab="", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add=TRUE)
} else if(sequence$contingency[i]=="right_torque"){  #shade right torque area
rect(0, 0, 2000, 50000, col=("lightgrey"))
hist(x = df$fly, breaks = 100,xlim = maxfly, xlab="", border= sequence$histocolor[i],  col = sequence$histocolor[i], main=paste("Period ", i), add=TRUE)
}
abline(v = 0, col="black", lwd=2, lty=2)
sequence$contingency[i]
hist(grouphistdata[[x]]$a_pos, breaks = 360, border = "grey40", col = "grey40", xlab=paste(FlyBehavior, "[arb units]"), main=paste("Pooled Position Histogram", groupnames[[x]]), xaxt='n', yaxs="i")
axis(side=1, at=c(-1800, -900, 0, 900, 1800))
#add quadrant borders
abline(v = -1350, col="black", lwd=1, lty="dotted") # adds a line at -135°
abline(v = -450, col="black", lwd=1, lty="dotted") # adds a line at -45°
abline(v = 450, col="black", lwd=1, lty="dotted") # adds a line at 45°
abline(v = 1350, col="black", lwd=1, lty="dotted") # adds a line at 135°
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
hist(grouphistdata[[x]]$a_pos, breaks = 360, border = "grey40", col = "grey40", xlab="", ylab="", main=paste("Pooled Position Histogram", groupnames[[x]]), xaxt='n', yaxs="i")
axis(side=1, at=c(-1800, -900, 0, 900, 1800))
#add quadrant borders
abline(v = -1350, col="black", lwd=1, lty="dotted") # adds a line at -135°
abline(v = -450, col="black", lwd=1, lty="dotted") # adds a line at -45°
abline(v = 450, col="black", lwd=1, lty="dotted") # adds a line at 45°
abline(v = 1350, col="black", lwd=1, lty="dotted") # adds a line at 135°
mtext(text = paste("Arena Position [degrees*10]"),
cex = 1,
side = 1,#side 1 = bottom
line = 2.5)
mtext(text = "Frequency",
cex = 1,
side = 2, #side 2 = left
line = 2)
source('B:/GitHub/DTSevaluations/HTML_DTS_project.R', echo=TRUE)
source('B:/GitHub/DTSevaluations/HTML_DTS_project.R', echo=TRUE)
sequence$type[i]
sequence$type[5]
any(c("yt","sw")) %in% sequence$type[i]
any(c("yt","sw")) %in% sequence$type[5]
c("yt","sw") %in% sequence$type[i]
c("yt","sw") %in% sequence$type[5]
any(c("yt","sw") %in% sequence$type[5])
any(c("yt","sw") %in% sequence$type[i])
any(c("yt","sw") %in% sequence$type[5])
source('B:/GitHub/DTSevaluations/HTML_DTS_project.R', echo=TRUE)
