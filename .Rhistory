point.args.pos = list(position = ggpp::position_jitternudge(width = 0.1, x = -0.22, nudge.from = "jittered")),
boxplot.args = list(fill="white", color = "black", outlier.shape = NA, size=1.1),
boxplot.args.pos = list(width = 0.12),
violin.args = list(color = NA, alpha = .8),
violin.args.pos = list(side = "r", width = 1)) +
stat_summary(fun.y = mean, color = "darkgrey", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
stat_summary(fun.y=median, color="black", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
scale_y_continuous(breaks = seq(-1, 1, .2), limits = c(-1,1)) +
scale_fill_manual(values = boxcolors) + #color of the violin plot
scale_color_manual(values = boxcolors) + #color of the points
guides(fill = 'none', color = 'none')+ # remove legends
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) +
theme(panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
axis.title.x=element_blank(),
panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.x = element_text(size=10), axis.text.y = element_text(size=10)) +
ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+
theme(aspect.ratio=3/NofGroups)+
ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[v]]], fill=group, color=group)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_signif(comparisons = list(c(groupnames)), map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes) +
geom_rain(point.args = list(size = 3),
point.args.pos = list(position = ggpp::position_jitternudge(width = 0.1, x = -0.22, nudge.from = "jittered")),
boxplot.args = list(fill="white", color = "black", outlier.shape = NA, size=1.1),
boxplot.args.pos = list(width = 0.12),
violin.args = list(color = NA, alpha = .8),
violin.args.pos = list(side = "r", width = 1)) +
stat_summary(fun.y = mean, color = "darkgrey", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
stat_summary(fun.y=median, color="black", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
scale_y_continuous(breaks = seq(-1, 1, .2), limits = c(-1,1)) +
scale_fill_manual(values = boxcolors) + #color of the violin plot
scale_color_manual(values = boxcolors) + #color of the points
guides(fill = 'none', color = 'none')+ # remove legends
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) +
theme(panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
axis.title.x=element_blank(),
panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.x = element_text(size=10), axis.text.y = element_text(size=10)) +
ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+
theme(aspect.ratio=3/NofGroups)
ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[v]]], fill=group, color=group)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_rain(point.args = list(size = 3),
point.args.pos = list(position = ggpp::position_jitternudge(width = 0.1, x = -0.22, nudge.from = "jittered")),
boxplot.args = list(fill="white", color = "black", outlier.shape = NA, size=1.1),
boxplot.args.pos = list(width = 0.12),
violin.args = list(color = NA, alpha = .8),
violin.args.pos = list(side = "r", width = 1)) +
stat_summary(fun.y = mean, color = "darkgrey", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
stat_summary(fun.y=median, color="black", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
scale_y_continuous(breaks = seq(-1, 1, .2), limits = c(-1,1)) +
scale_fill_manual(values = boxcolors) + #color of the violin plot
scale_color_manual(values = boxcolors) + #color of the points
guides(fill = 'none', color = 'none')+ # remove legends
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) +
theme(panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
axis.title.x=element_blank(),
panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.x = element_text(size=10), axis.text.y = element_text(size=10)) +
ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+
theme(aspect.ratio=3/NofGroups)
ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[v]]], fill=group, color=group)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_rain(point.args = list(size = 3),
point.args.pos = list(position = ggpp::position_jitternudge(width = 0.1, x = -0.22, nudge.from = "jittered")),
boxplot.args = list(fill="white", color = "black", outlier.shape = NA, size=1.1),
boxplot.args.pos = list(width = 0.12),
violin.args = list(color = NA, alpha = .8),
violin.args.pos = list(side = "r", width = 1)) +
geom_signif(comparisons = list(c(groupnames)), map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes) +
stat_summary(fun.y = mean, color = "darkgrey", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
stat_summary(fun.y=median, color="black", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
scale_y_continuous(breaks = seq(-1, 1, .2), limits = c(-1,1)) +
scale_fill_manual(values = boxcolors) + #color of the violin plot
scale_color_manual(values = boxcolors) + #color of the points
guides(fill = 'none', color = 'none')+ # remove legends
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) +
theme(panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
axis.title.x=element_blank(),
panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.x = element_text(size=10), axis.text.y = element_text(size=10)) +
ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+
theme(aspect.ratio=3/NofGroups)
ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[v]]], fill=group, color=group)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_rain(point.args = list(size = 3),
point.args.pos = list(position = ggpp::position_jitternudge(width = 0.1, x = -0.22, nudge.from = "jittered")),
boxplot.args = list(fill="white", color = "black", outlier.shape = NA, size=1.1),
boxplot.args.pos = list(width = 0.12),
violin.args = list(color = NA, alpha = .8),
violin.args.pos = list(side = "r", width = 1)) +
stat_summary(fun.y = mean, color = "darkgrey", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
stat_summary(fun.y=median, color="black", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
scale_y_continuous(breaks = seq(-1, 1, .2), limits = c(-1,1)) +
scale_fill_manual(values = boxcolors) + #color of the violin plot
scale_color_manual(values = boxcolors) + #color of the points
guides(fill = 'none', color = 'none')+ # remove legends
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) +
theme(panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
axis.title.x=element_blank(),
panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.x = element_text(size=10), axis.text.y = element_text(size=10)) +
ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+
theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = list(c(groupnames)), map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes)
ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[v]]])) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = plotOMparams, aes(group, plotOMparams[[OMvariables[v]]]), position=position_jitter(0.3), shape=21, size=3, colour="black", fill="grey50", alpha=0.4) +
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank(), panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = list(c(groupnames)), map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=1) +
samplesizes.annotate(boxes, samplesizes)
ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[v]]])) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = plotOMparams, aes(group, plotOMparams[[OMvariables[v]]]), position=position_jitter(0.3), shape=21, size=3, colour="black", fill="grey50", alpha=0.4) +
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank(), panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = list(c(groupnames)), map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=1.5) +
samplesizes.annotate(boxes, samplesizes)
ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[v]]], fill=group, color=group)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_rain(point.args = list(size = 3),
point.args.pos = list(position = ggpp::position_jitternudge(width = 0.1, x = -0.22, nudge.from = "jittered")),
boxplot.args = list(fill="white", color = "black", outlier.shape = NA, size=1.1),
boxplot.args.pos = list(width = 0.12),
violin.args = list(color = NA, alpha = .8),
violin.args.pos = list(side = "r", width = 1)) +
stat_summary(fun.y = mean, color = "darkgrey", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
stat_summary(fun.y=median, color="black", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
scale_y_continuous(breaks = seq(-1, 1, .2), limits = c(-1,1)) +
scale_fill_manual(values = boxcolors) + #color of the violin plot
scale_color_manual(values = boxcolors) + #color of the points
guides(fill = 'none', color = 'none')+ # remove legends
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) +
theme(panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
axis.title.x=element_blank(),
panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.x = element_text(size=10), axis.text.y = element_text(size=10)) +
ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+
theme(aspect.ratio=3/NofGroups)+
scale_y_continuous(breaks = seq(-1, 1, .5), limits = c(-1,1)) +
geom_signif(comparisons = list(c(groupnames)), map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes)
ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[v]]], fill=group, color=group)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_rain(point.args = list(size = 3),
point.args.pos = list(position = ggpp::position_jitternudge(width = 0.1, x = -0.22, nudge.from = "jittered")),
boxplot.args = list(fill="white", color = "black", outlier.shape = NA, size=1.1),
boxplot.args.pos = list(width = 0.12),
violin.args = list(color = NA, alpha = .8),
violin.args.pos = list(side = "r", width = 1)) +
stat_summary(fun.y = mean, color = "darkgrey", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
stat_summary(fun.y=median, color="black", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
scale_y_continuous(breaks = seq(-1, 1, .2), limits = c(-1.4,1.4)) +
scale_fill_manual(values = boxcolors) + #color of the violin plot
scale_color_manual(values = boxcolors) + #color of the points
guides(fill = 'none', color = 'none')+ # remove legends
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) +
theme(panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
axis.title.x=element_blank(),
panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.x = element_text(size=10), axis.text.y = element_text(size=10)) +
ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+
theme(aspect.ratio=3/NofGroups)+
scale_y_continuous(breaks = seq(-1, 1, .5), limits = c(-1,1)) +
geom_signif(comparisons = list(c(groupnames)), map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes)
ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[v]]], fill=group, color=group)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_rain(point.args = list(size = 3),
point.args.pos = list(position = ggpp::position_jitternudge(width = 0.1, x = -0.22, nudge.from = "jittered")),
boxplot.args = list(fill="white", color = "black", outlier.shape = NA, size=1.1),
boxplot.args.pos = list(width = 0.12),
violin.args = list(color = NA, alpha = .8),
violin.args.pos = list(side = "r", width = 1)) +
stat_summary(fun.y = mean, color = "darkgrey", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
stat_summary(fun.y=median, color="black", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
scale_y_continuous(breaks = seq(-1, 1, .2), limits = c(-1.4,1.4)) +
scale_fill_manual(values = boxcolors) + #color of the violin plot
scale_color_manual(values = boxcolors) + #color of the points
guides(fill = 'none', color = 'none')+ # remove legends
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 18) +
theme(panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
axis.title.x=element_blank(),
panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.x = element_text(size=12), axis.text.y = element_text(size=18)) +
ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+
theme(aspect.ratio=3/NofGroups)+
scale_y_continuous(breaks = seq(-1, 1, .5), limits = c(-1,1)) +
geom_signif(comparisons = list(c(groupnames)), map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes)
ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[v]]], fill=group, color=group)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_rain(point.args = list(size = 3),
point.args.pos = list(position = ggpp::position_jitternudge(width = 0.1, x = -0.22, nudge.from = "jittered")),
boxplot.args = list(fill="white", color = "black", outlier.shape = NA, size=1.1),
boxplot.args.pos = list(width = 0.12),
violin.args = list(color = NA, alpha = .8),
violin.args.pos = list(side = "r", width = 1)) +
stat_summary(fun.y = mean, color = "darkgrey", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
stat_summary(fun.y=median, color="black", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
scale_y_continuous(breaks = seq(-1, 1, .2), limits = c(-1.4,1.4)) +
scale_fill_manual(values = boxcolors) + #color of the violin plot
scale_color_manual(values = boxcolors) + #color of the points
guides(fill = 'none', color = 'none')+ # remove legends
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) +
theme(panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
axis.title.x=element_blank(),
panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.x = element_text(size=12), axis.text.y = element_text(size=18)) +
ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+
theme(aspect.ratio=3/NofGroups)+
scale_y_continuous(breaks = seq(-1, 1, .5), limits = c(-1,1)) +
geom_signif(comparisons = list(c(groupnames)), map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes)
ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[v]]], fill=group, color="black")) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_rain(point.args = list(size = 3),
point.args.pos = list(position = ggpp::position_jitternudge(width = 0.1, x = -0.22, nudge.from = "jittered")),
boxplot.args = list(fill="white", color = "black", outlier.shape = NA, size=1.1),
boxplot.args.pos = list(width = 0.12),
violin.args = list(color = NA, alpha = .8),
violin.args.pos = list(side = "r", width = 1)) +
stat_summary(fun.y = mean, color = "darkgrey", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
stat_summary(fun.y=median, color="black", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
scale_y_continuous(breaks = seq(-1, 1, .2), limits = c(-1.4,1.4)) +
scale_fill_manual(values = boxcolors) + #color of the violin plot
scale_color_manual(values = boxcolors) + #color of the points
guides(fill = 'none', color = 'none')+ # remove legends
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) +
theme(panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
axis.title.x=element_blank(),
panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.x = element_text(size=12), axis.text.y = element_text(size=18)) +
ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+
theme(aspect.ratio=3/NofGroups)+
scale_y_continuous(breaks = seq(-1, 1, .5), limits = c(-1,1)) +
geom_signif(comparisons = list(c(groupnames)), map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes)
ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[v]]], fill=group)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_rain(point.args = list(size = 3),
point.args.pos = list(position = ggpp::position_jitternudge(width = 0.1, x = -0.22, nudge.from = "jittered")),
boxplot.args = list(fill="white", color = "black", outlier.shape = NA, size=1.1),
boxplot.args.pos = list(width = 0.12),
violin.args = list(color = NA, alpha = .8),
violin.args.pos = list(side = "r", width = 1)) +
stat_summary(fun.y = mean, color = "darkgrey", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
stat_summary(fun.y=median, color="black", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
scale_y_continuous(breaks = seq(-1, 1, .2), limits = c(-1.4,1.4)) +
scale_fill_manual(values = boxcolors) + #color of the violin plot
scale_color_manual(values = boxcolors) + #color of the points
guides(fill = 'none', color = 'none')+ # remove legends
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) +
theme(panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
axis.title.x=element_blank(),
panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.x = element_text(size=12), axis.text.y = element_text(size=18)) +
ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+
theme(aspect.ratio=3/NofGroups)+
scale_y_continuous(breaks = seq(-1, 1, .5), limits = c(-1,1)) +
geom_signif(comparisons = list(c(groupnames)), map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes)
ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[v]]], fill=group, color=group)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_rain(point.args = list(size = 3),
point.args.pos = list(position = ggpp::position_jitternudge(width = 0.1, x = -0.22, nudge.from = "jittered")),
boxplot.args = list(fill="white", color = "black", outlier.shape = NA, size=1.1),
boxplot.args.pos = list(width = 0.12),
violin.args = list(color = NA, alpha = .8),
violin.args.pos = list(side = "r", width = 1)) +
stat_summary(fun.y = mean, color = "darkgrey", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
stat_summary(fun.y=median, color="black", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
scale_y_continuous(breaks = seq(-1, 1, .2), limits = c(-1.4,1.4)) +
scale_fill_manual(values = boxcolors) + #color of the violin plot
scale_color_manual(values = boxcolors) + #color of the points
guides(fill = 'none', color = 'none')+ # remove legends
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) +
theme(panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
axis.title.x=element_blank(),
panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.x = element_text(size=12), axis.text.y = element_text(size=18)) +
ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+
theme(aspect.ratio=3/NofGroups)+
scale_y_continuous(breaks = seq(-1, 1, .5), limits = c(-2,2)) +
geom_signif(comparisons = list(c(groupnames)), map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes)
ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[v]]], fill=group, color=group)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_rain(point.args = list(size = 3),
point.args.pos = list(position = ggpp::position_jitternudge(width = 0.1, x = -0.22, nudge.from = "jittered")),
boxplot.args = list(fill="white", color = "black", outlier.shape = NA, size=1.1),
boxplot.args.pos = list(width = 0.12),
violin.args = list(color = NA, alpha = .8),
violin.args.pos = list(side = "r", width = 1)) +
stat_summary(fun.y = mean, color = "darkgrey", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
stat_summary(fun.y=median, color="black", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
scale_y_continuous(breaks = seq(-1, 1, .2), limits = c(-1.4,1.4)) +
scale_fill_manual(values = boxcolors) + #color of the violin plot
scale_color_manual(values = boxcolors) + #color of the points
guides(fill = 'none', color = 'none')+ # remove legends
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) +
theme(panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
axis.title.x=element_blank(),
panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.x = element_text(size=12), axis.text.y = element_text(size=18)) +
ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+
theme(aspect.ratio=3/NofGroups)+
scale_y_continuous(breaks = seq(-1, 1, .5), limits = c(-1.2,1.2)) +
geom_signif(comparisons = list(c(groupnames)), map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes)
1.2*min(plotOMparams[[OMvariables[v]]])
1.2*max(plotOMparams[[OMvariables[v]]])
ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[v]]], fill=group, color=group)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_rain(point.args = list(size = 3),
point.args.pos = list(position = ggpp::position_jitternudge(width = 0.1, x = -0.22, nudge.from = "jittered")),
boxplot.args = list(fill="white", color = "black", outlier.shape = NA, size=1.1),
boxplot.args.pos = list(width = 0.12),
violin.args = list(color = NA, alpha = .8),
violin.args.pos = list(side = "r", width = 1)) +
stat_summary(fun.y = mean, color = "darkgrey", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
stat_summary(fun.y=median, color="black", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
scale_y_continuous(breaks = seq(-1, 1, .2), limits = c(-1.4,1.4)) +
scale_fill_manual(values = boxcolors) + #color of the violin plot
scale_color_manual(values = boxcolors) + #color of the points
guides(fill = 'none', color = 'none')+ # remove legends
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) +
theme(panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
axis.title.x=element_blank(),
panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.x = element_text(size=12), axis.text.y = element_text(size=18)) +
ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+
theme(aspect.ratio=3/NofGroups)+
ylim(1.2*min(plotOMparams[[OMvariables[v]]]), 1.2*max(plotOMparams[[OMvariables[v]]])) +
geom_signif(comparisons = list(c(groupnames)), map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5) +
samplesizes.annotate(boxes, samplesizes)
ggplot(plotOMparams, aes(group, plotOMparams[[OMvariables[v]]], fill=group, color=group)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_rain(point.args = list(size = 3),
point.args.pos = list(position = ggpp::position_jitternudge(width = 0.1, x = -0.22, nudge.from = "jittered")),
boxplot.args = list(fill="white", color = "black", outlier.shape = NA, size=1.1),
boxplot.args.pos = list(width = 0.12),
violin.args = list(color = NA, alpha = .8),
violin.args.pos = list(side = "r", width = 1)) +
stat_summary(fun.y = mean, color = "darkgrey", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
stat_summary(fun.y=median, color="black", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
scale_y_continuous(breaks = seq(-1, 1, .2), limits = c(-1.4,1.4)) +
scale_fill_manual(values = boxcolors) + #color of the violin plot
scale_color_manual(values = boxcolors) + #color of the points
guides(fill = 'none', color = 'none')+ # remove legends
ggtitle(paste("U-Test, p=", utest)) +
theme_light(base_size = 16) +
theme(panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
axis.title.x=element_blank(),
panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.x = element_text(size=12), axis.text.y = element_text(size=18)) +
ylab(paste(OMtitles[v], " [rel. units]", sep = ""))+
theme(aspect.ratio=3/NofGroups)+
ylim(1.2*min(plotOMparams[[OMvariables[v]]]), 1.2*max(plotOMparams[[OMvariables[v]]])) +
geom_signif(comparisons = list(c(groupnames)), map_signif_level= c("***"= signif[3],"**"= signif[2], "*"= signif[1]), textsize=8, vjust=0.5, color="black") +
samplesizes.annotate(boxes, samplesizes)
knitr::opts_chunk$set(echo = TRUE)
ggplot(mOMPIbefore, aes(variable, value, fill=variable, color=variable)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_rain(point.args = list(size = 3,
shape=as.character(mOMPIbefore$postPIs.group),
alpha=as.integer(as.factor(mOMPIbefore$postPIs.group))/max(as.integer(as.factor(mOMPIbefore$postPIs.group)))),
point.args.pos = list(position = ggpp::position_jitternudge(width = 0.1, x = -0.22, nudge.from = "jittered")),
boxplot.args = list(fill="white", color = "black", outlier.shape = NA, size=1.1),
boxplot.args.pos = list(width = 0.12),
violin.args = list(color = NA, alpha = .8),
violin.args.pos = list(side = "r", width = 1)) +
stat_summary(fun.y = mean, color = "darkgrey", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
stat_summary(fun.y=median, color="black", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
scale_y_continuous(breaks = seq(-1, 1, .2), limits = c(-1,1)) +
scale_fill_manual(values = boxcolors) + #color of the violin plot
scale_color_manual(values = boxcolors) + #color of the points
guides(fill = 'none', color = 'none')+ # remove legends
theme_light(base_size = 16) +
theme(panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
axis.title.x=element_blank(),
panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.x = element_text(size=10), axis.text.y = element_text(size=10)) + ylab(paste("Indices [rel. units]"))+
scale_x_discrete(labels=c("optomotor", "torque")) +
theme(aspect.ratio=2/1.2)
View(PIstat)
mOMPIbefore$value[[mOMPIbefore$variable[x]]]
mOMPIafter$variable
View(mOMPIbefore)
levels(mOMPIafter$variable)
as.factor(mOMPIafter$variable)
as.integer(mOMPIafter$variable)
as.integer(mOMPIbefore$variable)
as.integer(mOMPIafter$variable)-2
mOMPIbefore$value[[as.integer(mOMPIbefore$variable)==x]]
mOMPIbefore$value[[mOMPIbefore$variable)=="plotOMparamsBefore.AI.OM."]]
mOMPIbefore$value[[mOMPIbefore$variable=="plotOMparamsBefore.AI.OM."]]
subset(mOMPIbefore, variable %in% "plotOMparamsBefore.AI.OM.")
wilcox.test(subset(mOMPIbefore, variable %in% "plotOMparamsBefore.AI.OM."))
subset(mOMPIbefore, variable == "plotOMparamsBefore.AI.OM.")
wilcox.test(subset(mOMPIbefore, variable == "plotOMparamsBefore.AI.OM."))
mOMPIbefore[which(mOMPIbefore$variable == "plotOMparamsBefore.AI.OM.")]
mOMPIbefore[which(mOMPIbefore$variable == "plotOMparamsBefore.AI.OM."),3]
mOMPIbefore[which(mOMPIbefore$variable == "plotOMparamsBefore.AI.OM."),value]
mOMPIbefore[which(mOMPIbefore$variable == "plotOMparamsBefore.AI.OM."),mOMPIbefore$value]
mOMPIbefore[which(mOMPIbefore$variable == "plotOMparamsBefore.AI.OM."),3]
wilcox.test(mOMPIbefore[which(mOMPIbefore$variable == "plotOMparamsBefore.AI.OM."),3])
oma_before = signif(wilcox.test(mOMPIbefore[which(mOMPIbefore$variable == "plotOMparamsBefore.AI.OM."),3])$p.value, 3) #test against zero
pi_before = signif(wilcox.test(mOMPIbefore[which(mOMPIbefore$variable == "pretestPIs.category"),3])$p.value, 3) #test against zero
oma_after = signif(wilcox.test(mOMPIafter[which(mOMPIafter$variable == "plotOMparamsAfter.AI.OM."),3])$p.value, 3) #test against zero
pi_after = signif(wilcox.test(mOMPIafter[which(mOMPIafter$variable == "postestPIs.category"),3])$p.value, 3) #test against zero
View(mOMPIafter)
pi_after = signif(wilcox.test(mOMPIafter[which(mOMPIafter$variable == "postPIs.category"),3])$p.value, 3) #test against zero
wilcoxon<-numeric()
wilcoxon[1] = signif(wilcox.test(mOMPIbefore[which(mOMPIbefore$variable == "plotOMparamsBefore.AI.OM."),3])$p.value, 3) #test against zero
wilcoxon[2] = signif(wilcox.test(mOMPIbefore[which(mOMPIbefore$variable == "pretestPIs.category"),3])$p.value, 3) #test against zero
ggplot(mOMPIbefore, aes(variable, value, fill=variable, color=variable)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_rain(point.args = list(size = 3,
shape=as.character(mOMPIbefore$postPIs.group),
alpha=as.integer(as.factor(mOMPIbefore$postPIs.group))/max(as.integer(as.factor(mOMPIbefore$postPIs.group)))),
point.args.pos = list(position = ggpp::position_jitternudge(width = 0.1, x = -0.22, nudge.from = "jittered")),
boxplot.args = list(fill="white", color = "black", outlier.shape = NA, size=1.1),
boxplot.args.pos = list(width = 0.12),
violin.args = list(color = NA, alpha = .8),
violin.args.pos = list(side = "r", width = 1)) +
stat_summary(fun.y = mean, color = "darkgrey", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
stat_summary(fun.y=median, color="black", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
scale_y_continuous(breaks = seq(-1, 1, .2), limits = c(-1,1)) +
scale_fill_manual(values = boxcolors) + #color of the violin plot
scale_color_manual(values = boxcolors) + #color of the points
guides(fill = 'none', color = 'none')+ # remove legends
theme_light(base_size = 16) +
theme(panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
axis.title.x=element_blank(),
panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.x = element_text(size=10), axis.text.y = element_text(size=10)) + ylab(paste("Indices [rel. units]"))+
scale_x_discrete(labels=c("optomotor", "torque")) +
samplesizes.annotate(boxes, samplesizes) +
wilcox.annotate(boxes, wilcoxon) +
theme(aspect.ratio=2/1.2)
wilcoxon<-numeric()
wilcoxon[1] = signif(wilcox.test(mOMPIafter[which(mOMPIafter$variable == "plotOMparamsAfter.AI.OM."),3])$p.value, 3) #test against zero
wilcoxon[2] = signif(wilcox.test(mOMPIafter[which(mOMPIafter$variable == "postPIs.category"),3])$p.value, 3) #test against zero
ggplot(mOMPIafter, aes(variable, value, fill=variable, color=variable)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_rain(point.args = list(size = 3,
shape=as.character(mOMPIbefore$postPIs.group),
alpha=as.integer(as.factor(mOMPIbefore$postPIs.group))/max(as.integer(as.factor(mOMPIbefore$postPIs.group)))),
point.args.pos = list(position = ggpp::position_jitternudge(width = 0.1, x = -0.22, nudge.from = "jittered")),
boxplot.args = list(fill="white", color = "black", outlier.shape = NA, size=1.1),
boxplot.args.pos = list(width = 0.12),
violin.args = list(color = NA, alpha = .8),
violin.args.pos = list(side = "r", width = 1)) +
stat_summary(fun.y = mean, color = "darkgrey", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
stat_summary(fun.y=median, color="black", geom = "errorbar", aes(ymax = ..y.., ymin = ..y..), width = 0.2, size = 2.1)+
scale_y_continuous(breaks = seq(-1, 1, .2), limits = c(-1,1)) +
scale_fill_manual(values = boxcolors) + #color of the violin plot
scale_color_manual(values = boxcolors) + #color of the points
guides(fill = 'none', color = 'none')+ # remove legends
theme_light(base_size = 16) +
theme(panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
axis.title.x=element_blank(),
panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.x = element_text(size=10), axis.text.y = element_text(size=10)) + ylab(paste("Indices [rel. units]"))+
scale_x_discrete(labels=c("optomotor", "torque"))+
samplesizes.annotate(boxes, samplesizes) +
wilcox.annotate(boxes, wilcoxon) +
theme(aspect.ratio=2/1.2)
#### call RMarkdown for single fly evaluations ###############################################
rmarkdown::render(paste(start.wd,"/rmarkdown/single_fly.Rmd", sep=""),                  ######
output_file = paste(flyname,"qc.html", sep="_"),                      ######
output_dir = dataset.path)                                            ######
source("B:/GitHub/DTSevaluations/evaluate_datasets.R")
