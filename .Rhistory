theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
annotate("text",
x=1,
y=1.1,
label=paste("p=",wilcoxon[[1]]))+
annotate("text",
x=2,
y=1.1,
label=paste("p=",wilcoxon[[2]]))
length(PIstat[1])
lengths(PIstat[1])
lengths(PIstat[[1]])
length(PIstat[[1]])
length(PIstat[!is.na(PIstat[1])])
length(PIstat[!is.na(PIstat[[1]])])
length(!is.na(PIstat[[1]]))
!is.na(PIstat[[1]])
length(na.omit(PIstat[[1]]))
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = FALSE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
annotate("text",
x=1,
y=1.1,
label=paste("p=",wilcoxon[[1]], "\n N=", length(na.omit(PIstat[[1]]))))+
annotate("text",
x=2,
y=1.1,
label=paste("p=",wilcoxon[[2]], "\n N=", length(na.omit(PIstat[[2]]))))
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = FALSE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
wilcox.annotate(NofGroups, wilcoxon, PIstat)
wilcox.annotate <- function(NofGroups, wilcoxon, PIstat)
{    annotate("text",
x=1,
y=1.1,
label=paste("p=",wilcoxon[[1]], "\n N=", length(na.omit(PIstat[[1]]))))+
annotate("text",
x=2,
y=1.1,
label=paste("p=",wilcoxon[[2]], "\n N=", length(na.omit(PIstat[[2]]))))
}
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = FALSE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
wilcox.annotate(NofGroups, wilcoxon, PIstat)
wilcoxon
wilcoxon[1]
wilcoxon[[1]]
wilcox.annotate <- function(NofGroups, wilcoxon, PIstat)
{
annotate("text",
x=1,
y=1.1,
label="1")+
#              label=paste("p=",wilcoxon[[1]], "\n N=", length(na.omit(PIstat[[1]]))))+
annotate("text",
x=2,
y=1.1,
label="1")
#             label=paste("p=",wilcoxon[[2]], "\n N=", length(na.omit(PIstat[[2]]))))
}
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = FALSE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
wilcox.annotate(NofGroups, wilcoxon, PIstat)
wilcox.annotate <- function(wilcoxon, PIstat)
{
annotate("text",
x=1,
y=1.1,
label=paste("p=",wilcoxon[[1]], "\n N=", length(na.omit(PIstat[[1]]))))+
annotate("text",
x=2,
y=1.1,
label=paste("p=",wilcoxon[[2]], "\n N=", length(na.omit(PIstat[[2]]))))
}
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = FALSE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
wilcox.annotate(NofGroups, wilcoxon, PIstat)
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = FALSE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
wilcox.annotate(wilcoxon, PIstat)
wilcox.annotate <- function(wilcoxon, PIstat)
{
annotate("text",
x=1,
y=1.1,
label=paste("p=",wilcoxon[[1]], "\n N=", length(na.omit(PIstat[1]))))+
annotate("text",
x=2,
y=1.1,
label=paste("p=",wilcoxon[[2]], "\n N=", length(na.omit(PIstat[2]))))
}
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = FALSE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
wilcox.annotate(wilcoxon, PIstat)
wilcox.annotate <- function(wilcoxon, PIstat)
{
annotate("text",
x=1,
y=1.1,
label=paste("p=",wilcoxon[1], "\n N=", length(na.omit(PIstat[,1]))))+
annotate("text",
x=2,
y=1.1,
label=paste("p=",wilcoxon[2], "\n N=", length(na.omit(PIstat[,2]))))
}
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = FALSE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
wilcox.annotate(wilcoxon, PIstat)
wilcox.annotate <- function(wilcoxon, PIstat)
{
annotate("text",
x=1,
y=1.1,
label=paste("p=",as.numeric(wilcoxon[[1]]), "\n N=", length(na.omit(PIstat[,1]))))+
annotate("text",
x=2,
y=1.1,
label=paste("p=",as.numeric(wilcoxon[[2]]), "\n N=", length(na.omit(PIstat[,2]))))
}
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = FALSE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
wilcox.annotate(wilcoxon, PIstat)
wilcoxon[[1]]
is.numeric(wilcoxon[[1]])
na.omit(PIstat[,1])
length(na.omit(PIstat[,1]))
wilcox.annotate <- function(wilcoxon, PIstat)
{
annotate("text",
x=1,
y=1.1,
label=paste("p=",wilcoxon[[1]], "\n N=", length(na.omit(PIstat[,1]))))
#  +
#  annotate("text",
#             x=2,
#             y=1.1,
#             label=paste("p=",wilcoxon[[2]], "\n N=", length(na.omit(PIstat[,2]))))
}
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = FALSE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
wilcox.annotate(wilcoxon, PIstat)
wilcox.annotate <- function(NofGroups, wilcoxon, PIstat)
{
for(n in 1:NofGroups){
annotate("text",
x=n,
y=1.1,
label=paste("p=",wilcoxon[[n]], "\n N=", length(na.omit(PIstat[,n]))))
}
}
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = FALSE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
wilcox.annotate(NofGroups, wilcoxon, PIstat)
boxes<-c(1:NofGroups)
wilcox.annotate <- function(boxes, wilcoxon, PIstat)
{
annotate("text",
x=boxes,
y=1.1,
label=paste("p=",wilcoxon[[boxes]], "\n N=", length(na.omit(PIstat[,boxes]))))
}
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = FALSE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
wilcox.annotate(boxes, wilcoxon, PIstat)
View(wilcox.annotate)
stats<-lapply(boxes, wilcox.annotate(wilcoxon, PIstat))
lapply(boxes, wilcox.annotate)
lapply(boxes, wilcox.annotate(wilcoxon, PIstat))
sapply(boxes, wilcox.annotate(wilcoxon, PIstat))
rapply(boxes, wilcox.annotate(wilcoxon, PIstat))
lapply(boxes, wilcox.annotate(wilcoxon, PIstat))
wilcoxon[1]=1
wilcoxon=c(1,0.012)
wilcoxon[1]=2
test2[1]=1
lapply(boxes, wilcox.annotate(wilcoxon, PIstat))
lapply(boxes, wilcox.annotate(boxes, wilcoxon, PIstat))
lapply(boxes, wilcox.annotate(wilcoxon, PIstat))
samplesizes<-c(length(na.omit(PIstat[,boxes])))
apply(boxes, length(na.omit(PIstat[,boxes])))
apply(PIstat, function(x) length(na.omit(x)))
apply(PIstat, 1, function(x) length(na.omit(x)))
apply(PIstat, 2, function(x) length(na.omit(x)))
samplesizes<-apply(PIstat, 2, function(x) length(na.omit(x)))
samplesize[1]
samplesizes[1]
samplesizes<-as.numeric(apply(PIstat, 2, function(x) length(na.omit(x))))
wilcox.annotate <- function(boxes, wilcoxon, samplesizes)
{
annotate("text",
x=boxes,
y=1.1,
label=paste("p=",wilcoxon[boxes], "\n N=", samplesizes[boxes]))
}
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = FALSE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
wilcox.annotate(boxes, wilcoxon, samplesizes)
print(ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = FALSE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
wilcox.annotate(boxes, wilcoxon, samplesizes))
#Wilcoxon annotations
wilcox.annotate <- function(boxes, wilcoxon)
{
annotate("text",
x=boxes,
y=1.1,
label=paste("p=",wilcoxon[boxes]))
}
#samplesizes annotations
samplesizes.annotate <- function(boxes, samplesizes)
{
annotate("text",
x=boxes,
y=1.1,
label=paste("N=", samplesizes[boxes]))
}
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = FALSE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
wilcox.annotate(boxes, wilcoxon)+
samplesizes.annotate(boxes, samplesizes)
wilcox.annotate <- function(boxes, wilcoxon)
{
annotate("text",
x=boxes,
y=1.1,
label=paste("p=",wilcoxon[boxes]))
}
#samplesizes annotations
samplesizes.annotate <- function(boxes, samplesizes)
{
annotate("text",
x=boxes,
y=1.2,
label=paste("N=", samplesizes[boxes]))
}
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = FALSE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
wilcox.annotate(boxes, wilcoxon)+
samplesizes.annotate(boxes, samplesizes)
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
samplesizes.annotate(boxes, samplesizes)
install.packages("ggsignif")
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
samplesizes.annotate(boxes, samplesizes) +
geom_signif(comparisons = list(c("rutabaga mutant", "wild type Berlin")), map_signif_level=TRUE)
library(ggsignif)
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
samplesizes.annotate(boxes, samplesizes) +
geom_signif(comparisons = list(c("rutabaga mutant", "wild type Berlin")), map_signif_level=TRUE)
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
geom_signif(comparisons = list(c("rutabaga mutant", "wild type Berlin")), map_signif_level=TRUE) +
samplesizes.annotate(boxes, samplesizes)
samplesizes.annotate <- function(boxes, samplesizes)
{
annotate("text",
x=boxes,
y=-1.1,
label=paste("N=", samplesizes[boxes]))
}
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
geom_signif(comparisons = list(c("rutabaga mutant", "wild type Berlin")), map_signif_level=TRUE) +
samplesizes.annotate(boxes, samplesizes)
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = FALSE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
samplesizes.annotate(boxes, samplesizes) +
wilcox.annotate(boxes, wilcoxon)
wilcoxon<-numeric()
for(x in 1:NofGroups){wilcoxon[x] = signif(wilcox.test(PIstat[[x]])$p.value, 3)} #test all groups against zero
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = FALSE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=4/NofGroups)+
samplesizes.annotate(boxes, samplesizes) +
wilcox.annotate(boxes, wilcoxon)
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("Wilcoxon") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = list(c("rutabaga mutant", "wild type Berlin")), map_signif_level=TRUE) +
samplesizes.annotate(boxes, samplesizes)
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle("U-Test") +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = list(c("rutabaga mutant", "wild type Berlin")), map_signif_level=TRUE) +
samplesizes.annotate(boxes, samplesizes)
utest = signif(wilcox.test(PIstat[[1]],PIstat[[2]])$p.value, 3) #compare the two groups with a U-test
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle(paste("U-Test, p=", utest)) +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = list(c("rutabaga mutant", "wild type Berlin")), map_signif_level=TRUE) +
samplesizes.annotate(boxes, samplesizes)
if(utest<0.005){signif=TRUE}
signif
if(utest<0.005){significant=TRUE}
significant
significant=TRUE
if(utest<0.005){significant=TRUE} else {significant=FALSE}
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle(paste("U-Test, p=", utest)) +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = list(c("rutabaga mutant", "wild type Berlin")), map_signif_level=significant) +
samplesizes.annotate(boxes, samplesizes)
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle(paste("U-Test, p=", utest)) +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = list(c("rutabaga mutant", "wild type Berlin")), map_signif_level=  c("***"=0.0001,"**"=0.001, "*"=0.005)) +
samplesizes.annotate(boxes, samplesizes)
source('D:/brembs/GitHub/DTSevaluations/evaluate_DTS_project.R', echo=TRUE)
source('D:/brembs/GitHub/DTSevaluations/evaluate_DTS_project.R', echo=TRUE)
source('D:/brembs/GitHub/DTSevaluations/evaluate_DTS_project.R', echo=TRUE)
dev.off()
wilcox.test(PIstat[[1]],PIstat[[2]])
utest = signif(wilcox.test(PIstat[[1]],PIstat[[2]])$p.value, 3) #compare the two groups with a U-test
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle(paste("U-Test, p=", utest)) +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = list(c("rutabaga mutant", "wild type Berlin")), map_signif_level=  c("***"=0.0001,"**"=0.001, "*"=0.005)) +
samplesizes.annotate(boxes, samplesizes)
colnames(PIstat[1])
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle(paste("U-Test, p=", utest)) +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = list(c(colnames(PIstat[1]), colnames(PIstat[2]))), map_signif_level=  c("***"=0.0001,"**"=0.001, "*"=0.005)) +
samplesizes.annotate(boxes, samplesizes)
ggplot(melt(PIstat), aes(variable, value)) +
geom_hline(yintercept = 0, colour = "#887000", size = 1.2) +
geom_boxplot(fill = boxcolors, notch = TRUE, outlier.color=NA, width=0.8, size=0.6) +
geom_jitter(data = melt(PIstat), aes(variable, value), position=position_jitter(0.3), cex=2, color="grey80") +
ggtitle(paste("U-Test, p=", utest)) +
scale_y_continuous(breaks = seq(-1, 1, .2)) +
theme_light(base_size = 16) + theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank() ,panel.border = element_rect(size = 0.5, linetype = "solid", colour = "black", fill=NA)) +
theme(axis.text.y = element_text(size=18))+ ylab("PI [rel. units]")+ xlab("Groups")+ theme(aspect.ratio=3/NofGroups)+
geom_signif(comparisons = list(c(colnames(PIstat[1]), colnames(PIstat[2]))), map_signif_level= c("***"=0.0001,"**"=0.001, "*"=0.05)) +
samplesizes.annotate(boxes, samplesizes)
dev.off()
setwd(start.wd)
source('D:/brembs/GitHub/DTSevaluations/evaluate_DTS_project.R', echo=TRUE)
